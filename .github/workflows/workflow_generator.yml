name: Maharashtra Weather Update (All Districts)

on:
  schedule:
    - cron: "0 */3 * * *"
  workflow_dispatch:

jobs:
  update-all:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Update weather for all 36 districts
        run: |
          districts=(
            "Ahmednagar" "Akola" "Amravati" "Aurangabad" "Beed" "Bhandara" "Buldhana"
            "Chandrapur" "Dhule" "Gadchiroli" "Gondia" "Hingoli" "Jalgaon" "Jalna"
            "Kolhapur" "Latur" "Mumbai-City" "Mumbai-Suburban" "Nagpur" "Nanded"
            "Nandurbar" "Nashik" "Osmanabad" "Palghar" "Parbhani" "Pune" "Raigad"
            "Ratnagiri" "Sangli" "Satara" "Sindhudurg" "Solapur" "Thane"
            "Wardha" "Washim" "Yavatmal"
          )

          git config --local user.name "JuberBot"
          git config --local user.email "actions@github.com"

          for district in "${districts[@]}"; do
            echo "Updating weather for $district"

            # Weather fetch and save
            curl -s "https://wttr.in/${district}?format=3" > "${district}/${district}-weather.txt"

            # Add & commit changes
            git add "${district}/${district}-weather.txt"
            git commit -m "${district} weather update" || echo "No changes for $district"
          done

          git push
